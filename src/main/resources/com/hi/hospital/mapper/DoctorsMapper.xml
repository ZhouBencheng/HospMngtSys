<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hi.hospital.mapper.DoctorsMapper">

    <resultMap id="docMap" type="com.hi.hospital.entity.Doctors">
        <id column="doctor_id" property="doctorId" />
        <result column="job_number" property="jobNumber" />
        <result column="avatar" property="avatar" />
        <result column="NAME" property="name" />
        <result column="phone" property="phone" />
        <result column="registration_fee" property="registrationFee" />
        <result column="entry_date" property="entryDate" />
        <association property="departments" javaType="com.hi.hospital.entity.Departments">
            <result column="departments_name" property="departmentsName"></result>
        </association>
        <association property="professionalTitles" javaType="com.hi.hospital.entity.ProfessionalTitles">
            <result column="title_name" property="titleName"></result>
        </association>
    </resultMap>

    <select id="selectAll" resultMap="docMap">
        SELECT
            doctor_id,
            job_number,
            NAME,
            avatar,
            phone,
            registration_fee,
            entry_date,
            department_name,
            title_name
        FROM
            doctors doc,
            departments dep,
            professional_titles pt
        WHERE
            doc.department_id = dep.department_id
          AND doc.professional_title_id = pt.id
        <if test="jobNumber!=null and jobNumber!=''">
            AND doc.job_number = #{jobNumber}
        </if>

        <if test="name!=null and name!=''">
            AND doc.name = #{name}
        </if>

        <if test="deptId!=null and deptId!=''">
            AND doc.department_id = #{deptId}
        </if>

    </select>
</mapper>